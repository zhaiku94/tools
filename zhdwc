<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€åçš„æ™šé¤æ¸¸æˆ</title>
    <style>
        :root {
            --primary-color: #8b0000;
            --secondary-color: #a52a2a;
            --arrest-color: #dc3545;
            --expel-color: #6c757d;
            --present-color: #28a745;
            --revealed-color: #1890ff;
            --text-color: #333;
            --light-bg: #f5f5f5;
            --card-bg: white;
            --disabled-color: #adb5bd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: var(--light-bg);
            margin: 0;
            padding: 10px;
            color: var(--text-color);
            font-size: 16px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .section {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        
        .section-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-size: 1.3rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 8px;
            margin-bottom: 8px;
            font-size: 1rem;
            min-width: 100px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .player-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .player-card {
            background-color: var(--card-bg);
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .player-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .player-card.present {
            background-color: #f0fff0;
            border-left: 4px solid var(--present-color);
        }
        
        .player-card.arrested {
            background-color: #fff0f0;
            border-left: 4px solid var(--arrest-color);
            color: #666;
        }
        
        .player-card.expelled {
            background-color: #f8f9fa;
            border-left: 4px solid var(--expel-color);
            color: #999;
        }
        
        .player-card.revealed {
            background-color: #e6f7ff;
            border-left: 4px solid var(--revealed-color);
        }
        
        .role {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1rem;
        }
        
        .status {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .status.present {
            color: var(--present-color);
        }
        
        .status.arrested {
            color: var(--arrest-color);
        }
        
        .status.expelled {
            color: var(--expel-color);
        }
        
        .status.revealed {
            color: var(--revealed-color);
        }
        
        .player-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .timer {
            font-size: 1.5rem;
            text-align: center;
            margin: 15px 0;
        }
        
        .game-log {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            background-color: white;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
            word-break: break-word;
        }
        
        .night-phase {
            background-color: #333;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .day-phase {
            background-color: #f0e68c;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .arrest-btn {
            background-color: #2c3e50;
        }
        
        .expel-btn {
            background-color: var(--arrest-color);
        }
        
        .game-settings {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .setting-group-row {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .setting-group label {
            margin-right: 5px;
            min-width: 120px;
        }
        
        .setting-group input[type="number"] {
            width: 80px;
            padding: 5px;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .setting-group input[type="checkbox"] {
            transform: scale(1.2);
            margin-right: 5px;
        }
        
        .assign-roles-container {
            margin-top: 20px;
            text-align: center;
        }
        
        .name-input {
            margin-top: 5px;
            padding: 5px;
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .skill-btn {
            margin-top: 5px;
            padding: 3px 8px;
            font-size: 0.8rem;
            background-color: #17a2b8;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .skill-btn:disabled {
            background-color: var(--disabled-color);
            cursor: not-allowed;
        }
        
        /* ä¸»æŒäººæŒ‡å—æ ·å¼ */
        .host-guide {
            background-color: #f8f9fa;
            border-left: 4px solid #6c757d;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 8px;
            line-height: 1.8;
        }
        
        .host-guide h2 {
            color: #8b0000;
            margin-top: 0;
            font-size: 1.6rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #dee2e6;
        }
        
        .host-guide h3 {
            color: #495057;
            margin: 30px 0 20px;
            font-size: 1.4rem;
        }
        
        .host-guide h4 {
            color: #6c757d;
            margin: 25px 0 15px;
            font-size: 1.2rem;
        }
        
        .host-guide p {
            margin: 20px 0;
            font-size: 1.1rem;
        }
        
        .host-guide ul, .host-guide ol {
            margin: 20px 0;
            padding-left: 35px;
        }
        
        .host-guide li {
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .warning {
            background-color: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            margin: 25px 0;
            border-radius: 5px;
            color: #856404;
            font-weight: bold;
        }
        
        .host-guide strong {
            color: #8b0000;
        }
        
        /* èƒŒæ™¯æ•…äº‹æ ·å¼ */
        .story-background {
            background-color: #f5f5dc;
            border-left: 4px solid #8b4513;
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 8px;
            font-style: italic;
            line-height: 1.6;
        }
        
        .story-background h3 {
            color: #8b4513;
            margin-top: 0;
            font-size: 1.5rem;
            margin-bottom: 20px;
        }
        
        /* èƒœåˆ©æ¶ˆæ¯æ ·å¼ */
        .victory-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease-out;
        }
        
        .victory-message {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 80%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 3px solid gold;
            position: relative;
            overflow: hidden;
        }
        
        .victory-message::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, 
                rgba(255,215,0,0.2) 0%, 
                rgba(255,255,255,0.8) 50%, 
                rgba(255,215,0,0.2) 100%);
            z-index: -1;
            animation: shine 3s infinite;
        }
        
        .victory-title {
            font-size: 2.5rem;
            color: #8b0000;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }
        
        .victory-text {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
            font-weight: bold;
        }
        
        .victory-details {
            font-size: 1.1rem;
            margin-bottom: 25px;
            color: #555;
            line-height: 1.6;
        }
        
        .victory-btn {
            background: linear-gradient(to right, #8b0000, #a52a2a);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4);
        }
        
        .victory-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(139, 0, 0, 0.6);
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: confetti 5s ease-in-out infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }
        
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(360deg); opacity: 0; }
        }
        
        /* æ–°æ·»åŠ çš„ç©å®¶å§“åè¾“å…¥æ¡†æ ·å¼ */
        .player-names-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .player-names-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .player-names-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .player-names-hint {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        /* å¹³æ¿åŠä»¥ä¸Šå°ºå¯¸ */
        @media (min-width: 600px) {
            .player-card {
                width: calc(50% - 10px);
            }
            
            .setting-group {
                flex-direction: row;
                align-items: center;
            }
            
            .setting-group label {
                min-width: 150px;
            }
        }
        
        /* æ¡Œé¢å°ºå¯¸ */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .container {
                padding: 20px;
            }
            
            .player-card {
                width: calc(33.333% - 10px);
            }
            
            .action-buttons {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æœ€åçš„æ™šé¤æ¸¸æˆ</h1>
        
        <!-- èƒŒæ™¯æ•…äº‹éƒ¨åˆ† -->
        <div class="story-background">
            <h3>æ•…äº‹èƒŒæ™¯</h3>
            <p>å…¬å…ƒ33å¹´ï¼Œé€¾è¶ŠèŠ‚å‰å¤•ï¼Œè€¶è·¯æ’’å†·åŸç¬¼ç½©åœ¨ç´§å¼ çš„æ°”æ°›ä¸­ã€‚è€¶ç¨£ä¸ä»–çš„åäºŒé—¨å¾’å…±è¿›æœ€åçš„æ™šé¤ï¼Œç„¶è€Œåœ¨è¿™çœ‹ä¼¼å¹³é™çš„å¤œæ™šï¼Œæš—æµæ¶ŒåŠ¨...</p>
            <p>ç¥­å¸ä»¬æ—©å·²å¯¹è€¶ç¨£çš„æ•™å¯¼å¿ƒæ€€ä¸æ»¡ï¼Œæš—ä¸­ç­–åˆ’é€®æ•ä»–ï¼›çŠ¹å¤§ï¼ŒåäºŒé—¨å¾’ä¹‹ä¸€ï¼Œå·²è¢«ç¥­å¸æ”¶ä¹°ï¼Œå‡†å¤‡å‡ºå–ä»–çš„è€å¸ˆï¼›è€Œè€¶ç¨£æ—©å·²é¢„çŸ¥è¿™ä¸€åˆ‡ï¼Œå´ä¾ç„¶é€‰æ‹©å®Œæˆä»–çš„ä½¿å‘½ã€‚</p>
            <p>ä»Šæ™šï¼Œåœ¨è¿™æœ€åçš„æ™šé¤ä¸Šï¼Œå¿ è¯šä¸èƒŒå›ã€å…‰æ˜ä¸é»‘æš—çš„è¾ƒé‡å³å°†å±•å¼€ã€‚è°èƒ½åœ¨è¿™åœºå¿ƒçµçš„åšå¼ˆä¸­èƒœå‡ºï¼Ÿè°åˆèƒ½åšå®ˆä¿¡ä»°åˆ°æœ€åï¼Ÿ</p>
            <p>ç°åœ¨ï¼Œæ•…äº‹å°†åœ¨ä½ ä»¬æ‰‹ä¸­ç»§ç»­...</p>
        </div>
        
        <!-- ä¸»æŒäººæŒ‡å—éƒ¨åˆ† -->
        <div class="host-guide">
            <h2>ä¸»æŒäººæŒ‡å—</h2>
            
            <h3>æ¸¸æˆä¸‰å¤§é˜µè¥</h3>
            <ul>
                <li><strong>ç¥­å¸é˜µè¥</strong></li>
                <li><strong>çŠ¹å¤§é˜µè¥</strong></li>
                <li><strong>è€¶ç¨£å’Œé—¨å¾’é˜µè¥</strong></li>
            </ul>
            
            <h3>é˜µè¥è·èƒœæ¡ä»¶</h3>
            <ul>
                <li><strong>ç¥­å¸é˜µè¥</strong>ï¼šè€¶ç¨£è¢«é€®æ•æˆåŠŸ + æ‰€æœ‰é—¨å¾’å’Œç‰¹æ®Šé—¨å¾’ï¼ˆå½¼å¾—ã€è¥¿é—¨ã€å¤šé©¬ã€çº¦ç¿°ï¼‰çŠ¶æ€ä¸ºé©±é€æˆ–é€®æ•</li>
                <li><strong>çŠ¹å¤§é˜µè¥</strong>ï¼šè€¶ç¨£è¢«é€®æ•æˆåŠŸ + æ‰€æœ‰ç¥­å¸è¢«é©±é€ + çŠ¹å¤§æœªè¢«é©±é€</li>
                <li><strong>è€¶ç¨£å’Œé—¨å¾’é˜µè¥</strong>ï¼šé©±é€æ‰€æœ‰ç¥­å¸äººå£«å’ŒçŠ¹å¤§</li>
            </ul>
            
            <h3>æ¸¸æˆç»“æŸæ¡ä»¶</h3>
            <p>ä»»ä½•ä¸€æ–¹é˜µè¥è·èƒœæ¸¸æˆç»“æŸ</p>
            
            <h3>æ¸¸æˆæµç¨‹</h3>
            <p>é€‰æ‹©å’Œç¡®è®¤æ—¶ï¼Œè¯·ç”¨æ‰‹å±•ç¤ºç›¸åº”æ•°å­—çš„ç©å®¶ï¼ˆæ¯”å¦‚ï¼Œ1ä»£è¡¨1å·ç©å®¶ï¼‰</p>
            
            <h4>å¤œæ™šé€®æ•é˜¶æ®µ</h4>
            <p>æ‰€æœ‰äººè¯·é—­çœ¼</p>
            <ol>
                <li><strong>ç¥­å¸è¯·ççœ¼</strong> - è¯·ç¡®è®¤åŒä¼´ï¼›è¯·æŒ‡è®¤çŠ¹å¤§ï¼›è¯·é€‰æ‹©è¦é€®æ•çš„å¯¹è±¡ï¼Œç¥­å¸è¯·é—­çœ¼
                    <div class="warning">æ³¨æ„âš ï¸åœ¨ç¬¬3ä¸ªå¤œæ™šï¼Œå¯ä»¥ç›´æ¥å‘ä¸»æŒäººç¡®è®¤çŠ¹å¤§</div>
                </li>
                <li><strong>çŠ¹å¤§è¯·ççœ¼</strong> - è¯·è®°ä½è¿™æ˜¯è€¶ç¨£/ç¥­å¸ï¼ŒçŠ¹å¤§è¯·é—­çœ¼
                    <div class="warning">æ³¨æ„âš ï¸çŠ¹å¤§ç¡®è®¤å®Œè€¶ç¨£åï¼Œæ‰å¯ä»¥ç¡®è®¤ç¥­å¸ã€‚æ¯ä¸ªå¤œæ™šæœ€å¤šç¡®è®¤1ä¸ªäººã€‚</div>
                </li>
                <li><strong>è€¶ç¨£è¯·ççœ¼</strong> - è¯·è®°ä½è¿™æ˜¯çŠ¹å¤§/ç¥­å¸ï¼Œè€¶ç¨£è¯·é—­çœ¼
                    <div class="warning">æ³¨æ„âš ï¸è€¶ç¨£ç¡®è®¤å®ŒçŠ¹å¤§åï¼Œæ‰å¯ä»¥ç¡®è®¤ç¥­å¸ã€‚æ¯ä¸ªå¤œæ™šæœ€å¤šç¡®è®¤1ä¸ªäººã€‚</div>
                </li>
            </ol>
            
            <h4>å‡çº§ç‰ˆ</h4>
            <p>3.1 <strong>å½¼å¾—è¯·ççœ¼</strong> - æ˜¨æ™šè¢«é€®æ•çš„æ˜¯è¿™ä¸ªäººï¼Œä½ è¦æ•‘å—ï¼Ÿå¥½çš„ã€‚</p>
            
            <h4>ç™½å¤©é©±é€é˜¶æ®µ</h4>
            <p>æ‰€æœ‰äººè¯·ççœ¼ï¼Œä¸»æŒäººå®£å¸ƒæ˜¨æ™šè¢«é€®æ•æˆåŠŸçš„äººã€‚å¦‚æœæ˜¯çŠ¹å¤§ï¼ŒçŠ¹å¤§éœ€è¦ç«‹åˆ»å…¬å¼€èº«ä»½ï¼Œç„¶åè¢«é‡Šæ”¾è¿”åœºã€‚ä¹‹åä¸ä¼šå†è¢«é€®æ•ã€‚</p>
            <p>ä»1å·ä½å‘è¨€ï¼Œé¡ºæ—¶é’ˆè¿›è¡Œï¼Œæ¯äºº1åˆ†é’Ÿã€‚æ‰€æœ‰äººå‘è¨€å®Œæ¯•åï¼Œè¿›è¡Œå…¬å…±å‘è¨€3åˆ†é’Ÿã€‚ç„¶åï¼Œå¼€å§‹è¿›è¡Œé©±é€æŠ•ç¥¨ã€‚ç¥¨æ•°æœ€å¤šè€…è¢«é©±é€ã€‚ï¼ˆå‡çº§ç‰ˆï¼ŒæŸäº›è§’è‰²å¯ä»¥å‘åŠ¨æŠ€èƒ½ï¼‰</p>
            <p>å¦‚æœè¢«é©±é€æˆåŠŸçš„äººæ˜¯è€¶ç¨£ï¼Œè€¶ç¨£éœ€ç«‹åˆ»å…¬å¼€èº«ä»½ï¼Œå¹¶è¿”åœºã€‚ä¹‹åä¸ä¼šå†è¢«é©±é€ã€‚</p>
            <div class="warning">æ³¨æ„âš ï¸è¢«é©±é€æˆåŠŸå’Œé€®æ•æˆåŠŸçš„äººï¼Œå¤œæ™šä»éœ€å¤œæ™šé—­çœ¼ï¼Œç™½å¤©å¯ä»¥ç»§ç»­å‘è¨€ï¼Œä½†æ˜¯æ²¡æœ‰é©±é€æŠ•ç¥¨æƒã€‚ï¼ˆè¿›é˜¶ç‰ˆï¼šè¢«é€®æ•çš„æ²¡æœ‰æŠ•ç¥¨æƒã€‚è¢«é©±é€çš„äººæ•´å±€ä¸­ï¼Œåªæœ‰1æ¬¡è¿”åœºæŠ•ç¥¨æƒï¼Œå¹¶ä¸”éœ€è¦æœ‰äººæåå’Œå¤è®®ï¼Œå¤è®®äººæ•°ä¸å¾—å°‘äºåœ¨åœºäººæ•°çš„äºŒåˆ†ä¹‹ä¸€ï¼Œå‘ä¸Šå–æ•´ï¼‰</div>
            <p>å¦‚æœæ²¡æœ‰é˜µè¥è·èƒœï¼Œæ¸¸æˆç»§ç»­è¿›å…¥å¤œæ™šé€®æ•é˜¶æ®µ</p>
            
            <h3>è§’è‰²è¯´æ˜</h3>
            <ul>
                <li><strong>è€¶ç¨£</strong>ï¼šå¯ä»¥ç¡®è®¤ç¥­å¸å’ŒçŠ¹å¤§çš„èº«ä»½ï¼Œä½†æ˜¯ä¸å¯ä»¥å…¬å¼€çŠ¹å¤§çš„èº«ä»½å’ŒæŠ•ç¥¨é©±é€çŠ¹å¤§ï¼Œæ¯æ¬¡å¤œæ™šå¯ä»¥ç¡®è®¤ä¸€ä¸ªåäººï¼ˆç¥­å¸å’ŒçŠ¹å¤§ï¼‰çš„èº«ä»½ã€‚</li>
                <li><strong>çŠ¹å¤§</strong>ï¼šå¯ä»¥ç¡®è®¤è€¶ç¨£å’Œç¥­å¸èº«ä»½ï¼Œä½†æ˜¯çŠ¹å¤§ä¸èƒ½æŠŠé©±é€ç¥¨æŠ•ç»™è€¶ç¨£ã€‚</li>
                <li><strong>è€¶ç¨£å’Œé—¨å¾’é˜µè¥</strong>ï¼šä¸ä¼šè¯´è°</li>
            </ul>
            
            <h3>å‡çº§ä¸€</h3>
            <ul>
                <li><strong>å¥‹é”å…šäººè¥¿é—¨</strong>ï¼šè¢«é©±é€æ—¶ï¼Œå…¬å¼€èº«ä»½ï¼Œå¯ä»¥å¸¦èµ°ä¸€ä¸ªäºº</li>
                <li><strong>æ€€ç–‘çš„å¤šé©¬</strong>ï¼šè¢«é©±é€æ—¶ï¼Œå…¬å¼€èº«ä»½ï¼Œå¯ä»¥æ€€ç–‘å¹¶å…¬å¼€ä¸€ä¸ªäººçš„èº«ä»½</li>
                <li><strong>çº¦ç¿°</strong>ï¼šè¢«é€®æ•åï¼Œå…¬å¼€èº«ä»½ï¼Œä»¥åä¸èƒ½é€®æ•ï¼Œåªèƒ½è¢«é©±é€</li>
                <li><strong>å½¼å¾—</strong>ï¼šè¢«é©±é€æ—¶ï¼Œå…¬å¼€è‡ªå·±çš„èº«ä»½ï¼Œå¹¶å¦è®¤è‡ªå·±æ˜¯é—¨å¾’ï¼Œå…é™¤3æ¬¡è¢«é©±é€ï¼Œä¸”æ¥ä¸‹æ¥3ä¸ªç™½å¤©æ— æ³•å‚ä¸é©±é€æŠ•ç¥¨ã€‚ï¼ˆå¦‚æœåœ¨é€®æ•æˆåŠŸåï¼Œå·²å…¬å¼€èº«ä»½ã€‚åªéœ€è¦å¦è®¤è‡ªå·±æ˜¯é—¨å¾’ï¼Œç„¶åå…é™¤3æ¬¡è¢«é©±é€ï¼Œä¸”æ¥ä¸‹æ¥3ä¸ªç™½å¤©æ— æ³•å‚ä¸é©±é€æŠ•ç¥¨ã€‚ï¼‰å½¼å¾—æœ‰ä¸€æ¬¡é€®æ•æ— æ•ˆæŠ€èƒ½ï¼Œå¯ä»¥åœ¨å¤œæ™šé€®æ•æ—¶ä½¿ç”¨ã€‚
                    <div class="warning">æ³¨æ„âš ï¸å¦‚æœå½¼å¾—å·²ç»å…¬å¼€èº«ä»½ï¼Œåˆ™å¤±å»é€®æ•æ— æ•ˆæŠ€èƒ½</div>
                </li>
            </ul>
            
            <h3>å‡çº§äºŒ</h3>
            <p>ï¼ˆæ­¤ç©æ³•é—¨å¾’å¯ä»¥å› ä¸ºè½¯å¼±ï¼Œå¯ä»¥å‘åŠ¨ä¸å±äºè‡ªå·±çš„æŠ€èƒ½ï¼‰</p>
            <ul>
                <li>éæŠ€èƒ½äººå‘˜è¢«é©±é€æˆ–é€®æ•æ—¶ï¼Œå¯å‘åŠ¨æŠ€èƒ½ï¼ˆå¥‹é”å…šè¥¿é—¨ï¼Œå½¼å¾—ï¼Œå¤šé©¬ï¼Œçº¦ç¿°ï¼‰ï¼Œä½†ä¼šå¢åŠ è´¨ç–‘ç¯èŠ‚</li>
                <li>è´¨ç–‘æˆåŠŸï¼Œè¢«è´¨ç–‘è€…å…¬å¼€èº«ä»½ï¼Œå¹¶è¢«é©±é€</li>
                <li>è´¨ç–‘å¤±è´¥ï¼Œè´¨ç–‘äººä¸‹ä¸€è½®å°†ä¸èƒ½å‚ä¸é©±é€æŠ•ç¥¨</li>
                <li>ç¬¬äºŒæ¬¡è´¨ç–‘å¤±è´¥ï¼Œè´¨ç–‘äººç«‹åˆ»è¢«é©±é€</li>
                <li>å¦‚æœæ²¡æœ‰äººè´¨ç–‘ï¼Œåˆ™æŠ€èƒ½ç”Ÿæ•ˆ</li>
            </ul>
        </div>
        
        <div class="section">
            <div class="section-title">æ¸¸æˆè®¾ç½®</div>
            <div class="game-settings">
                <!-- æ–°å¢ç©å®¶å§“åè¾“å…¥æ¡† -->
                <div class="setting-group">
                    <label for="player-names" class="player-names-label">ç©å®¶å§“å:</label>
                    <input type="text" id="player-names" class="player-names-input" placeholder="è¾“å…¥ç©å®¶å§“åï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼ˆä¾‹å¦‚ï¼šå¼ ä¸‰ æå›› ç‹äº”ï¼‰">
                    <div class="player-names-hint">è¾“å…¥ç©å®¶å§“åï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚å§“åæ•°é‡å†³å®šç©å®¶æ•°é‡ï¼Œè¾“å…¥é¡ºåºå†³å®šç©å®¶åºå·ã€‚</div>
                </div>
                
                <div class="setting-group">
                    <label for="player-count">ç©å®¶æ•°é‡:</label>
                    <div class="setting-group-row">
                        <input type="number" id="player-count" min="4" max="20" value="12">
                    </div>
                </div>
                <div class="setting-group">
                    <label>ç‰¹æ®Šè§’è‰²:</label>
                    <div class="setting-group-row">
                        <label for="jesus">è€¶ç¨£:</label>
                        <input type="checkbox" id="jesus" checked>
                        
                        <label for="judas">çŠ¹å¤§:</label>
                        <input type="checkbox" id="judas" checked>
                        
                        <label for="disciple">é—¨å¾’:</label>
                        <input type="checkbox" id="disciple" checked>
                        
                        <label for="peter">å½¼å¾—:</label>
                        <input type="checkbox" id="peter">
                        
                        <label for="simon">å¥‹é”å…šäººè¥¿é—¨:</label>
                        <input type="checkbox" id="simon">
                        
                        <label for="thomas">å¤šé©¬:</label>
                        <input type="checkbox" id="thomas">
                        
                        <label for="john">çº¦ç¿°:</label>
                        <input type="checkbox" id="john">
                    </div>
                </div>
            </div>
            <div class="assign-roles-container">
                <button id="update-players">æ›´æ–°ç©å®¶</button>
                <button id="assign-roles">åˆ†é…è§’è‰²</button>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">ç©å®¶è§’è‰²</div>
            <div class="player-list" id="player-roles"></div>
        </div>
        
        <div class="section">
            <div class="section-title">æ¸¸æˆæµç¨‹</div>
            <div id="phase-indicator"></div>
            <div class="timer" id="timer">00:00</div>
            <div class="action-buttons">
                <button id="start-night" class="arrest-btn">å¤œæ™šé€®æ•</button>
                <button id="start-day" class="expel-btn">ç™½å¤©é©±é€</button>
                <button id="reset-timer">é‡ç½®è®¡æ—¶å™¨</button>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">æ¸¸æˆæ—¥å¿—</div>
            <div class="game-log" id="game-log"></div>
            <div style="text-align: center; margin-top: 10px;">
                <button id="clear-log">æ¸…ç©ºæ—¥å¿—</button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            players: [],
            phase: 'setup',
            timer: null,
            seconds: 0,
            winningFaction: null,
            roles: {
                scribe: 'ç¥­å¸',
                disciple: 'é—¨å¾’',
                jesus: 'è€¶ç¨£',
                judas: 'çŠ¹å¤§',
                peter: 'å½¼å¾—',
                simon: 'å¥‹é”å…šäººè¥¿é—¨',
                thomas: 'å¤šé©¬',
                john: 'çº¦ç¿°'
            },
            statusTypes: ['present', 'arrested', 'expelled', 'revealed'],
            statusTexts: {
                present: 'åœ¨åœº',
                arrested: 'é€®æ•',
                expelled: 'é©±é€',
                revealed: 'æŒ‡è®¤'
            },
            specialAbilities: {
                peter: 'é€®æ•æ— æ•ˆ',
                simon: 'è¢«é©±é€æ—¶å¸¦èµ°ä¸€äºº',
                thomas: 'è¢«é©±é€æ—¶æŸ¥éªŒèº«ä»½',
                john: 'è¢«é€®æ•åå…ç–«é€®æ•'
            },
            statusHistory: {
                jesus: [],
                judas: []
            },
            // æ‰€æœ‰è§’è‰²çš„çŠ¶æ€é¡ºåº
            getStatusOrder: function(role) {
                switch(role) {
                    case 'jesus': // è€¶ç¨£ï¼šåœ¨åœºã€é©±é€ã€é€®æ•
                        return ['present', 'expelled', 'arrested'];
                    case 'judas': // çŠ¹å¤§ï¼šåœ¨åœºã€é€®æ•ã€é©±é€
                        return ['present', 'arrested', 'expelled'];
                    case 'scribe': // ç¥­å¸ï¼šåœ¨åœºã€æŒ‡è®¤ã€é©±é€
                        return ['present', 'revealed', 'expelled'];
                    case 'disciple': // é—¨å¾’ï¼šåœ¨åœºã€é€®æ•ã€é©±é€
                        return ['present', 'arrested', 'expelled'];
                    case 'peter': // å½¼å¾—ï¼šåœ¨åœºã€é€®æ•ã€é©±é€
                        return ['present', 'arrested', 'expelled'];
                    case 'simon': // è¥¿é—¨ï¼šåœ¨åœºã€é€®æ•ã€é©±é€
                        return ['present', 'arrested', 'expelled'];
                    case 'thomas': // å¤šé©¬ï¼šåœ¨åœºã€é€®æ•ã€é©±é€
                        return ['present', 'arrested', 'expelled'];
                    case 'john': // çº¦ç¿°ï¼šåœ¨åœºã€é©±é€
                        return ['present', 'expelled'];
                    default:
                        return ['present', 'arrested', 'expelled', 'revealed'];
                }
            },
            // æ–°å¢ï¼šç©å®¶å§“ååˆ—è¡¨
            playerNames: []
        };

        // DOMå…ƒç´ 
        const elements = {
            playerNames: document.getElementById('player-names'),
            playerCount: document.getElementById('player-count'),
            jesusCheckbox: document.getElementById('jesus'),
            judasCheckbox: document.getElementById('judas'),
            discipleCheckbox: document.getElementById('disciple'),
            peterCheckbox: document.getElementById('peter'),
            simonCheckbox: document.getElementById('simon'),
            thomasCheckbox: document.getElementById('thomas'),
            johnCheckbox: document.getElementById('john'),
            updatePlayersBtn: document.getElementById('update-players'),
            assignRolesBtn: document.getElementById('assign-roles'),
            playerRolesDiv: document.getElementById('player-roles'),
            phaseIndicator: document.getElementById('phase-indicator'),
            timerDisplay: document.getElementById('timer'),
            startNightBtn: document.getElementById('start-night'),
            startDayBtn: document.getElementById('start-day'),
            resetTimerBtn: document.getElementById('reset-timer'),
            gameLog: document.getElementById('game-log'),
            clearLogBtn: document.getElementById('clear-log')
        };

        // åˆ†é…è§’è‰²
        elements.updatePlayersBtn.addEventListener('click', updatePlayers);
        elements.assignRolesBtn.addEventListener('click', assignRoles);
        elements.startNightBtn.addEventListener('click', startNightPhase);
        elements.startDayBtn.addEventListener('click', startDayPhase);
        elements.resetTimerBtn.addEventListener('click', resetTimer);
        elements.clearLogBtn.addEventListener('click', clearLog);

        // åˆå§‹åŒ–è®¡æ—¶å™¨
        resetTimer();

        // æ›´æ–°ç©å®¶åˆ—è¡¨å‡½æ•°
        function updatePlayers() {
            const namesInput = elements.playerNames.value.trim();
            
            if (!namesInput) {
                addLog('é”™è¯¯ï¼šè¯·è¾“å…¥ç©å®¶å§“å');
                return;
            }
            
            // ä½¿ç”¨ç©ºæ ¼åˆ†å‰²å§“å
            const names = namesInput.split(/\s+/).filter(name => name.length > 0);
            
            if (names.length < 4) {
                addLog('é”™è¯¯ï¼šæœ€å°‘éœ€è¦4åç©å®¶');
                return;
            }
            
            if (names.length > 20) {
                addLog('é”™è¯¯ï¼šæœ€å¤šæ”¯æŒ20åç©å®¶');
                return;
            }
            
            // æ›´æ–°ç©å®¶æ•°é‡è¾“å…¥æ¡†
            elements.playerCount.value = names.length;
            
            // ä¿å­˜ç©å®¶å§“å
            gameState.playerNames = names;
            
            addLog(`å·²æ›´æ–°ç©å®¶åˆ—è¡¨ï¼š${names.join('ã€')}ï¼Œå…±${names.length}åç©å®¶`);
        }

        // åˆ†é…è§’è‰²å‡½æ•°
        function assignRoles() {
            let playerCount;
            let playerNames = [];
            
            // å¦‚æœå·²ç»æœ‰ç©å®¶å§“ååˆ—è¡¨ï¼Œä½¿ç”¨å®ƒ
            if (gameState.playerNames && gameState.playerNames.length > 0) {
                playerCount = gameState.playerNames.length;
                playerNames = [...gameState.playerNames];
                addLog(`ä½¿ç”¨å·²è¾“å…¥çš„ç©å®¶å§“ååˆ—è¡¨ï¼Œå…±${playerCount}åç©å®¶`);
            } else {
                // å¦åˆ™ä½¿ç”¨ç©å®¶æ•°é‡è¾“å…¥æ¡†çš„å€¼
                playerCount = parseInt(elements.playerCount.value);
                
                if (playerCount < 4) {
                    addLog('é”™è¯¯ï¼šæœ€å°‘éœ€è¦4åç©å®¶');
                    return;
                }
                
                // ç”Ÿæˆé»˜è®¤ç©å®¶å§“å
                for (let i = 0; i < playerCount; i++) {
                    playerNames.push(`ç©å®¶ ${i + 1}`);
                }
            }
            
            gameState.players = [];
            gameState.statusHistory = {
                jesus: [],
                judas: []
            };
            const roles = [];
            
            // æ ¹æ®ç©å®¶æ•°é‡åˆ†é…è§’è‰²
            if (playerCount === 4) {
                roles.push('jesus', 'judas', 'scribe', 'disciple');
            } else if (playerCount === 5) {
                roles.push('jesus', 'judas', 'scribe', 'scribe', 'disciple');
            } else if (playerCount >= 6 && playerCount <= 11) {
                roles.push('jesus', 'judas', 'scribe', 'scribe');
                for (let i = 4; i < playerCount; i++) {
                    roles.push('disciple');
                }
            } else {
                const scribeCount = Math.max(2, Math.floor(playerCount / 4));
                const discipleCount = Math.max(playerCount - 3 - scribeCount, Math.floor(playerCount / 2));
                
                roles.push('jesus', 'judas');
                
                for (let i = 0; i < scribeCount; i++) {
                    roles.push('scribe');
                }
                
                for (let i = 0; i < discipleCount; i++) {
                    roles.push('disciple');
                }
                
                while (roles.length < playerCount) {
                    roles.push('disciple');
                }
            }
            
            // æ·»åŠ ç‰¹æ®Šè§’è‰²
            if (elements.peterCheckbox.checked) {
                const discipleIndex = roles.indexOf('disciple');
                if (discipleIndex !== -1) {
                    roles[discipleIndex] = 'peter';
                }
            }
            
            if (elements.simonCheckbox.checked) {
                const discipleIndex = roles.indexOf('disciple');
                if (discipleIndex !== -1) {
                    roles[discipleIndex] = 'simon';
                }
            }
            
            if (elements.thomasCheckbox.checked) {
                const discipleIndex = roles.indexOf('disciple');
                if (discipleIndex !== -1) {
                    roles[discipleIndex] = 'thomas';
                }
            }
            
            if (elements.johnCheckbox.checked) {
                const discipleIndex = roles.indexOf('disciple');
                if (discipleIndex !== -1) {
                    roles[discipleIndex] = 'john';
                }
            }
            
            // éšæœºåˆ†é…è§’è‰²
            shuffleArray(roles);
            
            // åˆ›å»ºç©å®¶å¯¹è±¡
            for (let i = 0; i < playerCount; i++) {
                gameState.players.push({
                    id: i + 1,
                    role: roles[i],
                    status: 'present',
                    name: playerNames[i],
                    skills: {
                        peter: roles[i] === 'peter' ? {used: false} : null,
                        simon: roles[i] === 'simon' ? {used: false} : null,
                        thomas: roles[i] === 'thomas' ? {used: false} : null,
                        john: roles[i] === 'john' ? {used: false} : null
                    }
                });
            }
            
            // æ˜¾ç¤ºè§’è‰²åˆ†é…
            displayPlayerRoles();
            
            // è®¡ç®—å„è§’è‰²æ•°é‡
            const roleCounts = {};
            roles.forEach(role => {
                roleCounts[role] = (roleCounts[role] || 0) + 1;
            });
            
            let logMessage = `å·²ä¸º ${playerCount} åç©å®¶åˆ†é…è§’è‰²ï¼š`;
            for (const [role, count] of Object.entries(roleCounts)) {
                logMessage += `${gameState.roles[role]} ${count}äººï¼Œ`;
            }
            addLog(logMessage.slice(0, -1));
        }

        // æ˜¾ç¤ºç©å®¶è§’è‰²
        function displayPlayerRoles() {
            elements.playerRolesDiv.innerHTML = '';
            
            gameState.players.forEach(player => {
                const card = document.createElement('div');
                card.className = `player-card ${player.status}`;
                
                // æ„å»ºæŠ€èƒ½æŒ‰é’®HTML
                let skillsHtml = '';
                if (player.role === 'peter' && !player.skills.peter.used && player.status !== 'revealed') {
                    skillsHtml += `<button class="skill-btn" onclick="useSkill(${player.id}, 'peter')">ä½¿ç”¨é€®æ•æ— æ•ˆ</button>`;
                }
                if (player.role === 'simon' && !player.skills.simon.used && player.status === 'expelled') {
                    skillsHtml += `<button class="skill-btn" onclick="useSkill(${player.id}, 'simon')">é€‰æ‹©å¸¦èµ°ä¸€äºº</button>`;
                }
                if (player.role === 'thomas' && !player.skills.thomas.used && player.status === 'expelled') {
                    skillsHtml += `<button class="skill-btn" onclick="useSkill(${player.id}, 'thomas')">æŸ¥éªŒä¸€äººèº«ä»½</button>`;
                }
                if (player.role === 'john' && !player.skills.john.used && player.status === 'arrested') {
                    skillsHtml += `<button class="skill-btn" onclick="useSkill(${player.id}, 'john')">ä½¿ç”¨å…ç–«é€®æ•</button>`;
                }
                
                // åœ¨ç©å®¶å§“åå‰æ·»åŠ åºå·
                card.innerHTML = `
                    <div class="player-name">${player.id}. ${player.name}</div>
                    <div class="role">è§’è‰²: ${gameState.roles[player.role]}</div>
                    <div class="status ${player.status}">çŠ¶æ€: ${gameState.statusTexts[player.status]}</div>
                    <input type="text" class="name-input" placeholder="è¾“å…¥ç©å®¶å§“å" value="${player.name}">
                    ${skillsHtml}
                `;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶åˆ‡æ¢ç©å®¶çŠ¶æ€
                card.addEventListener('click', (e) => {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') return;
                    
                    const statusOrder = gameState.getStatusOrder(player.role);
                    const currentIndex = statusOrder.indexOf(player.status);
                    let nextIndex = (currentIndex + 1) % statusOrder.length;
                    
                    player.status = statusOrder[nextIndex];
                    
                    // è®°å½•çŠ¶æ€å˜æ›´å†å²
                    if (player.role === 'jesus' || player.role === 'judas') {
                        gameState.statusHistory[player.role].push({
                            status: player.status,
                            timestamp: Date.now(),
                            message: `${player.name} çŠ¶æ€å˜æ›´ä¸º: ${gameState.statusTexts[player.status]}`
                        });
                    }
                    
                    // å¦‚æœå½¼å¾—çŠ¶æ€å˜ä¸ºæŒ‡è®¤ï¼Œç§»é™¤é€®æ•æ— æ•ˆæŠ€èƒ½
                    if (player.role === 'peter' && player.status === 'revealed') {
                        player.skills.peter.used = true;
                        addLog(`${player.name} (å½¼å¾—) å·²æŒ‡è®¤èº«ä»½ï¼Œå¤±å»é€®æ•æ— æ•ˆæŠ€èƒ½`);
                    }
                    
                    // æ›´æ–°å¡ç‰‡æ ·å¼å’Œæ–‡æœ¬
                    card.className = `player-card ${player.status}`;
                    const statusElement = card.querySelector('.status');
                    statusElement.className = `status ${player.status}`;
                    statusElement.textContent = `çŠ¶æ€: ${gameState.statusTexts[player.status]}`;
                    
                    addLog(`${player.name} çŠ¶æ€å˜æ›´ä¸º: ${gameState.statusTexts[player.status]}`);
                    
                    // æ£€æŸ¥è·èƒœæ¡ä»¶
                    checkWinConditions();
                    
                    // é‡æ–°æ¸²æŸ“ç©å®¶åˆ—è¡¨
                    displayPlayerRoles();
                });
                
                // æ·»åŠ å§“åè¾“å…¥æ¡†äº‹ä»¶
                const nameInput = card.querySelector('.name-input');
                nameInput.addEventListener('change', (e) => {
                    const newName = e.target.value.trim() || `ç©å®¶ ${player.id}`;
                    player.name = newName;
                    card.querySelector('.player-name').textContent = `${player.id}. ${newName}`;
                    addLog(`ç©å®¶ ${player.id} å§“åå˜æ›´ä¸º: ${newName}`);
                });
                
                elements.playerRolesDiv.appendChild(card);
            });
        }

        // æ£€æŸ¥è·èƒœæ¡ä»¶
        function checkWinConditions() {
            // æ£€æŸ¥ç¥­å¸é˜µè¥è·èƒœæ¡ä»¶ï¼šè€¶ç¨£è¢«é€®æ• + æ‰€æœ‰é—¨å¾’å’Œç‰¹æ®Šé—¨å¾’çŠ¶æ€ä¸ºé©±é€æˆ–é€®æ•
            const jesusArrested = gameState.players.some(p => p.role === 'jesus' && p.status === 'arrested');
            const allDisciplesHandled = gameState.players
                .filter(p => p.role === 'disciple' || 
                            p.role === 'peter' || 
                            p.role === 'simon' || 
                            p.role === 'thomas' || 
                            p.role === 'john')
                .every(p => p.status === 'arrested' || p.status === 'expelled');
            
            if (jesusArrested && allDisciplesHandled) {
                gameState.winningFaction = 'scribe';
                showVictoryMessage('ç¥­å¸é˜µè¥è·èƒœï¼è€¶ç¨£è¢«é€®æ•å¹¶å¤„ç†äº†æ‰€æœ‰é—¨å¾’ï¼ˆåŒ…æ‹¬ç‰¹æ®Šé—¨å¾’ï¼‰');
                return true;
            }
            
            // æ£€æŸ¥çŠ¹å¤§é˜µè¥è·èƒœæ¡ä»¶ï¼šè€¶ç¨£è¢«é€®æ• + æ‰€æœ‰ç¥­å¸è¢«é©±é€ + çŠ¹å¤§æœªè¢«é©±é€
            const allScribesExpelled = gameState.players
                .filter(p => p.role === 'scribe')
                .every(p => p.status === 'expelled');
            
            const judasNotExpelled = gameState.players
                .some(p => p.role === 'judas' && p.status !== 'expelled');
            
            if (jesusArrested && allScribesExpelled && judasNotExpelled) {
                gameState.winningFaction = 'judas';
                showVictoryMessage('çŠ¹å¤§é˜µè¥è·èƒœï¼è€¶ç¨£è¢«é€®æ•åæ‰€æœ‰ç¥­å¸è¢«é©±é€ä¸”çŠ¹å¤§æœªè¢«é©±é€');
                return true;
            }
            
            // æ£€æŸ¥è€¶ç¨£å’Œé—¨å¾’é˜µè¥è·èƒœæ¡ä»¶ï¼šæ‰€æœ‰ç¥­å¸å’ŒçŠ¹å¤§è¢«é©±é€
            const allOpponentsExpelled = gameState.players
                .filter(p => p.role === 'scribe' || p.role === 'judas')
                .every(p => p.status === 'expelled');
            
            if (allOpponentsExpelled) {
                gameState.winningFaction = 'jesus';
                showVictoryMessage('è€¶ç¨£å’Œé—¨å¾’é˜µè¥è·èƒœï¼é©±é€äº†æ‰€æœ‰ç¥­å¸å’ŒçŠ¹å¤§');
                return true;
            }
            
            return false;
        }

        // æ˜¾ç¤ºè·èƒœæ¶ˆæ¯
        function showVictoryMessage(message) {
            const overlay = document.createElement('div');
            overlay.className = 'victory-overlay';
            
            const victoryDiv = document.createElement('div');
            victoryDiv.className = 'victory-message';
            
            let victoryDetails = '';
            if (gameState.winningFaction === 'scribe') {
                victoryDetails = `
                    <div class="victory-details">
                        <p>ç¥­å¸é˜µè¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å–å¾—äº†èƒœåˆ©ï¼š</p>
                        <ul>
                            <li>è€¶ç¨£è¢«æˆåŠŸé€®æ•</li>
                            <li>æ‰€æœ‰é—¨å¾’å’Œç‰¹æ®Šé—¨å¾’ï¼ˆå½¼å¾—ã€è¥¿é—¨ã€å¤šé©¬ã€çº¦ç¿°ï¼‰çŠ¶æ€ä¸ºé©±é€æˆ–é€®æ•</li>
                        </ul>
                    </div>
                `;
            } else if (gameState.winningFaction === 'judas') {
                victoryDetails = `
                    <div class="victory-details">
                        <p>çŠ¹å¤§é˜µè¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å–å¾—äº†èƒœåˆ©ï¼š</p>
                        <ul>
                            <li>è€¶ç¨£è¢«æˆåŠŸé€®æ•</li>
                            <li>æ‰€æœ‰ç¥­å¸è¢«æˆåŠŸé©±é€</li>
                            <li>çŠ¹å¤§æœªè¢«é©±é€</li>
                        </ul>
                    </div>
                `;
            } else if (gameState.winningFaction === 'jesus') {
                victoryDetails = `
                    <div class="victory-details">
                        <p>è€¶ç¨£å’Œé—¨å¾’é˜µè¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å–å¾—äº†èƒœåˆ©ï¼š</p>
                        <ul>
                            <li>é©±é€äº†æ‰€æœ‰ç¥­å¸äººå£«</li>
                            <li>é©±é€äº†çŠ¹å¤§</li>
                        </ul>
                    </div>
                `;
            }
            
            victoryDiv.innerHTML = `
                <div class="victory-title">ğŸ‰ æ¸¸æˆç»“æŸ ğŸ‰</div>
                <div class="victory-text">${message}</div>
                ${victoryDetails}
                <button class="victory-btn" onclick="resetGame()">é‡æ–°å¼€å§‹</button>
            `;
            
            // æ·»åŠ å½©è‰²çº¸å±‘æ•ˆæœ
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = Math.random() * 100 + '%';
                confetti.style.backgroundColor = getRandomColor();
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.width = Math.random() * 10 + 5 + 'px';
                confetti.style.height = Math.random() * 10 + 5 + 'px';
                overlay.appendChild(confetti);
            }
            
            overlay.appendChild(victoryDiv);
            document.body.appendChild(overlay);
            
            if (gameState.timer) clearInterval(gameState.timer);
            
            addLog(`æ¸¸æˆç»“æŸï¼š${message}`);
        }

        // è·å–éšæœºé¢œè‰²
        function getRandomColor() {
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8800', '#8800ff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            const overlay = document.querySelector('.victory-overlay');
            if (overlay) overlay.remove();
            
            gameState.players = [];
            gameState.phase = 'setup';
            gameState.winningFaction = null;
            gameState.statusHistory = {
                jesus: [],
                judas: []
            };
            resetTimer();
            
            elements.playerRolesDiv.innerHTML = '';
            clearLog();
            
            addLog('æ¸¸æˆå·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°åˆ†é…è§’è‰²');
        }

        // ä½¿ç”¨æŠ€èƒ½å‡½æ•°
        function useSkill(playerId, skillType) {
            const player = gameState.players.find(p => p.id === playerId);
            if (!player || !player.skills[skillType] || player.skills[skillType].used) return;
            
            player.skills[skillType].used = true;
            
            switch(skillType) {
                case 'peter':
                    player.status = 'present';
                    addLog(`${player.name} (å½¼å¾—) ä½¿ç”¨äº†é€®æ•æ— æ•ˆæŠ€èƒ½ï¼ŒçŠ¶æ€æ¢å¤ä¸ºåœ¨åœº`);
                    break;
                    
                case 'simon':
                    addLog(`${player.name} (å¥‹é”å…šäººè¥¿é—¨) ä½¿ç”¨äº†è¢«é©±é€æ—¶å¸¦èµ°ä¸€äººçš„æŠ€èƒ½`);
                    break;
                    
                case 'thomas':
                    addLog(`${player.name} (å¤šé©¬) ä½¿ç”¨äº†è¢«é©±é€æ—¶æŸ¥éªŒä¸€äººèº«ä»½çš„æŠ€èƒ½`);
                    break;
                    
                case 'john':
                    player.status = 'present';
                    addLog(`${player.name} (çº¦ç¿°) ä½¿ç”¨äº†å…ç–«é€®æ•æŠ€èƒ½ï¼ŒçŠ¶æ€æ¢å¤ä¸ºåœ¨åœº`);
                    break;
            }
            
            checkWinConditions();
            displayPlayerRoles();
        }

        // å¼€å§‹å¤œæ™šé˜¶æ®µ
        function startNightPhase() {
            gameState.phase = 'night';
            elements.phaseIndicator.innerHTML = '<div class="night-phase">å¤œæ™šé˜¶æ®µ - ç¥­å¸è¿›è¡Œé€®æ•</div>';
            addLog('è¿›å…¥å¤œæ™šé€®æ•é˜¶æ®µï¼Œç¥­å¸é€‰æ‹©è¦é€®æ•çš„ç›®æ ‡');
            resetTimer();
            startTimer();
        }

        // å¼€å§‹ç™½å¤©é˜¶æ®µ
        function startDayPhase() {
            gameState.phase = 'day';
            elements.phaseIndicator.innerHTML = '<div class="day-phase">ç™½å¤©é˜¶æ®µ - è®¨è®ºå¹¶æŠ•ç¥¨é©±é€</div>';
            addLog('è¿›å…¥ç™½å¤©é©±é€é˜¶æ®µï¼Œç©å®¶è®¨è®ºå¹¶æŠ•ç¥¨å†³å®šé©±é€è°');
            resetTimer();
            startTimer();
        }

        // è®¡æ—¶å™¨åŠŸèƒ½
        function startTimer() {
            if (gameState.timer) clearInterval(gameState.timer);
            gameState.timer = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            gameState.seconds++;
            const minutes = Math.floor(gameState.seconds / 60);
            const seconds = gameState.seconds % 60;
            elements.timerDisplay.textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function resetTimer() {
            if (gameState.timer) clearInterval(gameState.timer);
            gameState.seconds = 0;
            elements.timerDisplay.textContent = '00:00';
        }

        // æ—¥å¿—åŠŸèƒ½
        function addLog(message) {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.textContent = `[${timeString}] ${message}`;
            elements.gameLog.appendChild(logEntry);
            elements.gameLog.scrollTop = elements.gameLog.scrollHeight;
        }

        function clearLog() {
            elements.gameLog.innerHTML = '';
            addLog('æ—¥å¿—å·²æ¸…ç©º');
        }

        // è¾…åŠ©å‡½æ•°ï¼šéšæœºæ‰“ä¹±æ•°ç»„
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // å…¨å±€æš´éœ²useSkillå‡½æ•°
        window.useSkill = useSkill;
        window.resetGame = resetGame;
    </script>
</body>
</html>
